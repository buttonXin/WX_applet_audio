<view class="container">
  <!-- 顶部销毁提示（计时结束显示） -->
  <view class="destroy-tip" wx:if="{{isDestroyed}}">图片已被销毁</view>

  <!-- 倒计时区域（5/10秒模式显示，未销毁时展示） -->
  <view class="countdown-wrap" wx:if="{{showCountdown && !isDestroyed}}">
    <text class="countdown-text">剩余查看时间：{{countdown}} 秒</text>
  </view>
  
   <!-- 图片显示区域 -->
   <view class="image-box" wx:if="{{!isDestroyed}}">
    <!-- 未加载时显示提示 -->
    <view class="loading-box" wx:if="{{!imageUrl}}" bindtap="loadImageContent">
      <text class="placeholder-text">点击加载图片内容</text>
    </view>
    
    <!-- 加载完成后显示图片，点击可预览 -->
    <image 
      wx:if="{{imageUrl}}" 
      src="{{imageUrl}}" 
      mode="aspectFit" 
      class="display-image"
      bindtap="openFullScreenPreview"
      catchlongpress="onImageLongPress"
    />
    
    <view class="loading-box" wx:if="{{isDestroyed}}">
      <text class="placeholder-text">图片已销毁，无法查看</text>
    </view>
  </view>
  
  <!-- 底部按钮 -->
  <button class="action-btn" bindtap="goToUpload">
    我也分享一个
  </button>

<!-- 全屏 Image 预览层（默认隐藏） -->
 <!-- 保持图片比例，完整显示 -->
  <!-- 拦截长按事件 -->
<view class="fullscreen-preview" wx:if="{{showPreview}}" bindtap="closeFullScreenPreview">
  <!-- 全屏显示的 Image -->
  <image 
    src="{{imageUrl}}" 
    mode="aspectFit" 
    style="width: 100vw; height: 100vh;"
    catchlongpress="onImageLongPress" 
  />
  <!-- 关闭按钮（阻止点击穿透） -->
  <view class="preview-close-btn" bindtap="closeFullScreenPreview" catchtap="">
    <text>×</text>
  </view>
</view>

  <!-- ========== 新增：previewCanvas  wx:if="{{isIos}}" 节点（用于绘制水印） ========== -->
  <canvas 
    type="2d" 
    id="previewCanvas" 
    class="preview-canvas"
   
  />
</view>