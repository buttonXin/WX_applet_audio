<view class="page">
  <!-- <view class="share-title">{{pageTitle}}</view> -->

  <scroll-view class="feed" scroll-y>
    <block wx:for="{{feedList}}" wx:key="id">
    <view wx:if="{{item.type === 'text'}}" class="card text-card"   >
    <!-- 可复制的文本 -->
      <text selectable="true" 
      user-select="true"
      space="ensp"
      decode="false">{{item.content}}</text>
    </view>

      <view wx:elif="{{item.type === 'media'}}"
        class="card media-card"
        data-id="{{item.id}}"
        bindtap="onPreviewMedia">
        <image wx:if="{{item.mediaType === 'image'}}"
          class="media-img"
          mode="widthFix"
          src="{{item.tempUrl}}" />
          
        <view wx:else class="video-preview">
          <image class="media-img" mode="aspectFill" src="{{item.poster}}" wx:if="{{item.poster}}"></image>
          <view class="video-mask">
            <text class="video-icon">▶</text>
            <text class="video-tips">点击播放/全屏</text>
          </view>
        </view>
      </view>
    </block>

    <view wx:if="{{!feedList.length}}" class="empty">暂无分享内容</view>
  </scroll-view>

  <view class="fab">
    <button class="fab-btn share"   bindtap="onDaySmile" wx:if="{{showSmileBtn}}" >开心一刻</button>
    <button class="fab-btn share"   bindtap="onShare" open-type="share"  >转发</button>
  </view>

  <!-- 自定义底部弹窗（方案2） -->
  <view class="custom-modal-mask" wx:if="{{showCustomModal}}" bindtap="closeCustomModal"></view>
  <view class="custom-modal-content" wx:if="{{showCustomModal}}">
    <!-- 弹窗标题 -->
    <view class="modal-title">{{smileTitle}}</view>
    <!-- 文本内容（支持换行和滚动） -->
    <scroll-view class="modal-text-area" scroll-y>
      <text class="modal-text"  selectable="true" 
      user-select="true"
      space="ensp"
      decode="false" >{{processedText}}</text>
    </scroll-view>
    <!-- 关闭按钮 -->
    <button class="modal-close-btn" bindtap="closeCustomModal">关闭</button>
  </view>

</view>
